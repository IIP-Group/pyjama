<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jammer Models &mdash; PyJama 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sionna.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Channel Models" href="channel_models.html" />
    <link rel="prev" title="API Documentation" href="pyjama.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyJama
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="pyjama.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Jammer Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="channel_models.html">Channel Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="pilots.html">Custom Pilot Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="mitigation.html">Jammer Mitigation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mitigation.html#module-pyjama.mitigation.POS">Projection onto Orthogonal Subspace (POS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mitigation.html#module-pyjama.mitigation.IAN">LMMSE treating Interference as Noise (IAN)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="simulation_model.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#channel-visualization">Channel Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#utility-functions">Utility Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyJama</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="pyjama.html">API Documentation</a> &raquo;</li>
      <li>Jammer Models</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-pyjama.jammer">
<span id="jammer-models"></span><h1>Jammer Models<a class="headerlink" href="#module-pyjama.jammer" title="Permalink to this heading"></a></h1>
<p>This module provides classes for simulating one or multiple jammers.
They are meant to be used to simulate jammers in the context of OFDM-based communication.</p>
<p>The main way of functioning is the following:</p>
<div class="line-block">
<div class="line">1. Build a communication pipeline between “regular” UEs and BSs.</div>
<div class="line">2. Instantiate an additional channel model between the jammers and the BSs.</div>
<div class="line">3. Instantiate a jammer, using the channel created in step 2.</div>
<div class="line">4. Add the jammer to the communication pipeline, right after the channel between the UEs and the BSs like so:</div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_jammed</span> <span class="o">=</span> <span class="n">jammer</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">rho</span><span class="p">])</span>
</pre></div>
</div>
<p>The module consists of two main classes: <a class="reference internal" href="#pyjama.jammer.OFDMJammer" title="pyjama.jammer.OFDMJammer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMJammer</span></code></a> and <a class="reference internal" href="#pyjama.jammer.TimeDomainOFDMJammer" title="pyjama.jammer.TimeDomainOFDMJammer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeDomainOFDMJammer</span></code></a>.
The former is to be used for simulations solely in the frequency domain, while the latter is to be used for simulations in the time domain.</p>
<p><cite>TimeDomainOFDMJammer</cite> can hence be used to jammers which violate the OFDM assumptions, i.e. not sending a cyclic prefix. The simulation is much slower, however.</p>
<p><cite>OFDMJammer</cite> currently has much more functionality implemented, and can i.e. be used to simulate learning/smart jammers.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyjama.jammer.OFDMJammer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyjama.jammer.</span></span><span class="sig-name descname"><span class="pre">OFDMJammer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyjama/jammer.html#OFDMJammer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyjama.jammer.OFDMJammer" title="Permalink to this definition"></a></dt>
<dd><p>Used to simulate a jammer in the frequency domain only (i.e. sending a cyclic prefix). The jammer signal is generated through the given (Jammer-BS) channel model.</p>
<p>It can be trained, and support several other functionalities, which are described in the following.</p>
<dl>
<dt>Jamming Types</dt><dd><p>Jamming types refer to which resource elements are jammed. This can additionally be modified by the shape of <span class="math notranslate nohighlight">\(\rho\)</span> (see below).
The following jamming types are supported:</p>
<ul class="simple">
<li><p>Barrage Jamming: All resource elements are jammed.</p></li>
<li><p>Pilot Jamming: Only pilot resource elements are jammed.</p></li>
<li><p>Data Jamming: Only data resource elements are jammed.</p></li>
<li><p>Non-Silent Jamming: Only non-silent resource elements are jammed. This is similar to pilot jamming, but does not jam the “silent” pilot symbols where jammer usually is estimated.</p></li>
</ul>
<p>The power of the symbols sent by the jammer will be scaled so that the mean power of each resource element over the whole resource grid is equal to <span class="math notranslate nohighlight">\(\rho\)</span>.</p>
</dd>
<dt>Sparse Jamming</dt><dd><p>Sparse jamming refers to the fact that only a fraction of the resource elements are jammed. This is controlled by the parameters <cite>density_symbols</cite> and <cite>density_subcarriers</cite>.
A value of 1.0 means that all resource elements are jammed, while a value of 0.0 means that no resource elements are jammed.</p>
<p>This is done by nulling said percentage of rows or columns of the resource grid. Hence, it is meant to be understood not as an exact number of resource elements, but rounded to the next integer.</p>
<p>Sparsity is ill-defined for non-barrage jammers. For example, pilots might not be evenly distributed. It would then not be clear what sparsity means. Hence, sparsity is only supported for barrage jammers.</p>
</dd>
<dt>Jamming Power &amp; Jamming Pattern</dt><dd><p>The jamming power is controlled by the parameter <span class="math notranslate nohighlight">\(\rho\)</span>. It is given for every call of the jammer, and can be thought of as the square of coefficients which the jammer symbols are multiplied by.
It might be a single value, or a tensor of shape broadcastable to <cite>[batch_size, num_tx, num_tx_ant, num_ofdm_symbols, fft_size]</cite>, where <cite>num_tx</cite> and <cite>num_tx_ant</cite> are the number of jammers and their antennas, respectively.</p>
<p>One can hence e.g. jam only a part of the resource grid by using passing in a tensor of shape <cite>[num_ofdm_symbols, fft_size]</cite>, where several resource elements are zero,
or regulate the power of different jammers by passing in a tensor of shape <cite>[num_tx, 1, 1, 1]</cite>, with different values for each jammer.</p>
</dd>
<dt>Different Sampling Methods</dt><dd><p>The jammers can be thought of as UEs, which sample their symbols <span class="math notranslate nohighlight">\(x\)</span> somehow with power <span class="math notranslate nohighlight">\(E[|x|^2] = 1\)</span>. These symbols are then scaled by <span class="math notranslate nohighlight">\(\sqrt{\rho}\)</span>, possibly nulled (see above) and sent through the jammer channel.
The result is then added to the received signal.</p>
<p>The interface of this class accepts a number of strings for predefined sampling methods. Alternatively, a constellation which is randomly sampled
or a callable which acts as sampling function can be passed in. See documentation of the input parameter <cite>sampler</cite> for the specific types.</p>
</dd>
<dt>Training</dt><dd><p>In general, the jammer can be trained by setting <cite>trainable=True</cite>. Weights (i.e. coefficients of the sampled jammer symbols) can then be learned.</p>
<p>As parameters to an instance of this class, one can pass a mask, a constraint and a boolean <cite>constraint_integrated</cite>.
The mask is a boolean tensor of shape broadcastable to <cite>[num_tx, num_tx_ant, num_ofdm_symbols, fft_size]</cite>.
If <cite>True</cite>, the corresponding weight is trainable. If <cite>False</cite>, the weight is held constant at 1.0.</p>
<p>To all trainable weights, a constraint is applied. By default, this constrains the mean power of those weights to be <span class="math notranslate nohighlight">\(\leq 1.0\)</span>.</p>
<p>This constraint can either be applied after each step of the optimizer, or part of the calculation itself. This is controlled by the boolean <cite>constraint_integrated</cite>.
Empirically speaking, the former might help breaking out of local minima (as the optimizer just takes a step in direction of the unconstrained optimum, the constraint is just applied afterwards)
while the latter helps with convergence (as the constraint is reflected in the gradient).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_model</strong> (<em>ChannelModel</em>) – Instance of <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.ChannelModel" title="(in Sionna)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sionna.channel.ChannelModel</span></code></a>.Channel between jammer(s) and BS(s).</p></li>
<li><p><strong>rg</strong> (<em>ResourceGrid</em>) – Instance of <a class="reference external" href="https://nvlabs.github.io/sionna/api/ofdm.html#sionna.ofdm.ResourceGrid" title="(in Sionna)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sionna.ofdm.ResourceGrid</span></code></a>. Resource grid of the OFDM system.</p></li>
<li><p><strong>num_tx</strong> (<em>int</em>) – Number of jammers.</p></li>
<li><p><strong>num_tx_ant</strong> (<em>int</em>) – Number of antennas of each jammer.</p></li>
<li><p><strong>jamming_type</strong> (<em>str</em>) – One of [“barrage”, “pilot”, “data”, “non_silent”].</p></li>
<li><p><strong>density_symbols</strong> (<em>float</em>) – Fraction of symbol times which are jammed. Must be in between 0 and 1.</p></li>
<li><p><strong>density_subcarriers</strong> (<em>float</em>) – Fraction of subcarriers which are jammed. Must be in between 0 and 1.</p></li>
<li><p><strong>normalize_channel</strong> (<em>bool</em>) – Whether to normalize the channel. If True, the channel is normalized so that for each link the mean energy of each channel coefficient is 1.0.
(this is just for the channel coefficients).</p></li>
<li><p><strong>return_channel</strong> (<em>bool</em>) – Whether to return the jammer channel frequency response should be returned in addition to the jammed signal.</p></li>
<li><p><strong>sampler</strong> (str, instance of <a class="reference external" href="https://nvlabs.github.io/sionna/api/mapping.html#sionna.mapping.Constellation" title="(in Sionna)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>, or callable) – If str, one of [“uniform”, “gaussian”].
If instance of <a class="reference external" href="https://nvlabs.github.io/sionna/api/mapping.html#sionna.mapping.Constellation" title="(in Sionna)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>, the constellation is sampled randomly.
If callable, the callable is used as sampling function. It should have signature <code class="docutils literal notranslate"><span class="pre">(shape,</span> <span class="pre">dtype)</span> <span class="pre">-&gt;</span> <span class="pre">tf.Tensor</span></code>.
In the first two cases, the mean energy of the sampled symbols is 1.0. In the last case, the caller is responsible for the energy of the sampled symbols.</p></li>
<li><p><strong>trainable</strong> (<em>bool</em>) – Whether the jammer weights are trainable.</p></li>
<li><p><strong>trainable_mask</strong> (None, or tensor broadcastable to <cite>[num_tx, num_tx_ant, num_ofdm_symbols, fft_size]</cite>) – If None, all weights are trainable. If tensor, only weights where the mask is True are trainable.</p></li>
<li><p><strong>training_constraint</strong> (None, callable or instance of <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/constraints/Constraint" title="(in TensorFlow v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tf.keras.constraints.Constraint</span></code></a>) – Constraint to be applied to the trainable weights.
If None, no constraint is applied.
The callable should take a tensor as argument and return a tensor of the same shape.</p></li>
<li><p><strong>constraint_integrated</strong> (<em>bool</em>) – If True, the constraint is integrated into the network. If False, the constraint is applied after each optimization step.</p></li>
<li><p><strong>dtype</strong> (<em>tf.complex</em>) – Data type of the jammer symbols. Defaults to tf.complex64.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Unjammed signal. Shape</p></li>
<li><p><strong>rho</strong> (<em>broadcastable to [batch_size, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.float</em>) – Power of jammer signal. See section “Jamming Power &amp; Jamming Pattern” above for details.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(y_jammed, h_freq_jammer) or y_jammed</strong> (<em>Tuple or Tensor</em>)</p></li>
<li><p><strong>y_jammed</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Input signal with jammer interference added.</p></li>
<li><p><strong>h_freq_jammer</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Frequency response of jammer channel. Only returned if <code class="docutils literal notranslate"><span class="pre">return_channel</span></code> is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyjama.jammer.TimeDomainOFDMJammer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyjama.jammer.</span></span><span class="sig-name descname"><span class="pre">TimeDomainOFDMJammer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyjama/jammer.html#TimeDomainOFDMJammer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyjama.jammer.TimeDomainOFDMJammer" title="Permalink to this definition"></a></dt>
<dd><p>This class is meant ot simulate jammers in the time domain channel. It is much slower than <a class="reference internal" href="#pyjama.jammer.OFDMJammer" title="pyjama.jammer.OFDMJammer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMJammer</span></code></a>, but can be used to simulate jammers which violate the OFDM assumptions, i.e. not sending a cyclic prefix.
It thus functions similarily to <a class="reference internal" href="#pyjama.jammer.OFDMJammer" title="pyjama.jammer.OFDMJammer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMJammer</span></code></a>, with the following differences:</p>
<ul class="simple">
<li><p>Some functionality is not supported, such as learning jammer weights. This might be implemented in the future.</p></li>
<li><p>The input signal is assumed to be in the time domain. The output can be chosen to be in the time domain or frequency domain using the parameter <cite>return_domain</cite>.</p></li>
<li><p>Cyclic prefix will or will not be sent depending on the parameter <cite>send_cyclic_prefix</cite>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_model</strong> (<em>ChannelModel</em>) – Instance of <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.ChannelModel" title="(in Sionna)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sionna.channel.ChannelModel</span></code></a>.Channel between jammer(s) and BS(s).</p></li>
<li><p><strong>rg</strong> (<em>ResourceGrid</em>) – Instance of <a class="reference external" href="https://nvlabs.github.io/sionna/api/ofdm.html#sionna.ofdm.ResourceGrid" title="(in Sionna)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sionna.ofdm.ResourceGrid</span></code></a>. Resource grid of the OFDM system.</p></li>
<li><p><strong>num_tx</strong> (<em>int</em>) – Number of jammers.</p></li>
<li><p><strong>num_tx_ant</strong> (<em>int</em>) – Number of antennas of each jammer.</p></li>
<li><p><strong>send_cyclic_prefix</strong> (<em>bool</em>) – If true, the jammer adheres to the OFDM assumptions and sends a cyclic prefix. If false, the jammer sends randomly sampled symbols instead.</p></li>
<li><p><strong>normalize_channel</strong> (<em>bool</em>) – Whether to normalize the channel. If True, the channel is normalized so that for each link the mean energy of each channel coefficient is 1.0.</p></li>
<li><p><strong>return_channel</strong> (<em>bool</em>) – If true,</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pyjama.html" class="btn btn-neutral float-left" title="API Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="channel_models.html" class="btn btn-neutral float-right" title="Channel Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Fabian Ulbricht, Gian Marti, Reinhard Wiesmayr.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>